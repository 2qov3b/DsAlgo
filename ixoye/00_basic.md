# Basic
* Simple: [What happens when you type in ‘www.cnn.com’ in your browser](https://syedali.net/2013/08/18/what-happens-when-you-type-in-www-cnn-com-in-your-browser/)?

_DNS_: A DNS lookup resolves http://www.cnn.com. At first the Linux client will look in it’s `name service cache daemon` to see if this request has been _cached_ from before. If not, then the request has to be sent to the `name server`. This happens when the dns request is sent to the name server specified in your `/etc/resolv.conf` on the client. The DNS resolver is usually your _local router_ if you are at home. The router will forward all _DNS requests_ to the resolver specified in it’s configuration, which it may have gotten from Comcast. The Comcast DNS server will forward this request to the `.com root name servers`. These will look up the _NS of cnn.com_. CNN.com name servers are specified when the domain is registered with the registrar. The request is then sent to to the CNN.com name servers which will look up http://www.cnn.com in their zone files and reply with the request. There is a forward lookup and a reverse lookup zone file. The _forward lookup_ matches hostname to IP address. There are two kinds of requests that are made, one is a _recursive_ and the other is a _non recursive_. A recursive query is when the client requests an answer which the DNS server has to find out and return. A non-recursive query is when the DNS server does not return the end answer, it’s upto to the client to find that out by talking to the next resolver in line. Keep in mind that each DNS server may have it’s _own cache_, so at any point in time the reply may come from cache if an answer is available. Caching has it’s own intricacies, and I will cover that in a DNS related blog.

_Network communication_: Network communication is when a `3 way TCP handshake` happens between the client and the server, that includes a `syn`, `sync-ack`, and then an `ack`. Once the client has the _IP address from the above DNS_ it makes a connection to the server. The client in our case will use it’s `routing table` to see if there is an entry for CNN.com’s network, if there is no entry, then the client will send the request for connection or _sync packet_ to the _default gateway_. The default gateway does the same thing, it tries to find an entry for the the _destination network_, and when it cannot find it the packet is sent to the default gateway. This happens until the packet reaches the Internet gateway which is running [BGP](https://en.wikipedia.org/wiki/Border_Gateway_Protocol). The BGP routing table contains the list of all _public IP address_ that have been assigned by _ISP’s_. This will contain CNN.com’s public IP address and the way to get to it. Comcast will then set the destination address of the packet to belong to CNN.com and send it across the Internet. Once it reaches http://www.cnn.com, the destination will acknowledge the SYNC packet with an ACK and also send it’s own sync. This is the 2nd part of the 3 way TCP handshake. (Sync-Ack). The same routing happens on the way back at which point the client send an ACK and the connection is established. One important question to ask here is that how does the client know which host is in it’s network and which host is not? The answer is based on the `netmask`. For instance is the client IP is 10.1.1.100 and the netmask is 255.255.255.0, the client knows that the range 10.1.1.[0-256] is it’s _local area subnet_, and the rest is outside of the local area subnet. The client uses [ARP](https://en.wikipedia.org/wiki/Address_Resolution_Protocol) or address resolution protocol to figure out which `MAC address` to send the packet to at [layer 2](https://en.wikipedia.org/wiki/Data_link_layer). If the default gateway is 10.1.1.1, the client will send an ARP request saying ‘Who has 10.1.1.1?’. This ARP request is heard by the router which will then respond with it’s MAC address and the client will encapsulate the packet with the MAC address of the router.

_HTTP_: Once the destination receives the packet, let’s say http://www.cnn.com is running behind a _http load balancer_, in which case the load balancer can be using in-line or [DSR](https://blog.envoyproxy.io/introduction-to-modern-network-load-balancing-and-proxying-a57f6ff80236). In-line means that the load balancer will handle all incoming and outgoing connection between the client and the http server. DSR or direct server return means that the incoming connections many come through the load balancer, but the outgoing connections will be between the web server and the client. Further details of this will be in my load balancer blog. Apache when it receives the incoming request on _port 80_ will then either use a forked process or a thread to pass the request to. Apache has two modes of running, one is _worker.c_ and the other is _pre-fork_. In `pre-fork` Apache uses processes that have been forked. In `worker.c` it uses _threads_. Threads consumes less resources, but is more complex. Since _pre-fork_ is by default, let’s say Apache forked off a process to handle our request.

If you are asked this question of ‘What happens when you type in in your browser?’, the above is a good start. At various points in the conversation you can talk more in depth about a particular topic. For instance with networking you can break down further and go into TCP/UDP differences and also talk about routing protocols such as RIP, OSPF, BGP. When it comes to DNS you can talk about the SOA record, what it means, and also about the other DNS records. Additionally you can talk about how to setup a BIND server. In regards to HTTP you can talk about how to setup Apache, difference between encrypted and un-encrypted traffic, and also go more in depth about SSL.

* Detailed: [What happens when you type google.com into your browser's address box and press enter](https://github.com/alex/what-happens-when)?
